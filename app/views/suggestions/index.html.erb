<div class="cover">
  <p
      class='text-dashboard'
      style="position: absolute; left: 50%; top: 134px; transform: translate(-50%); z-index: 1000; font-weight: 700; font-size: 28px; color: white; text-shadow: rgba(0, 0, 0, 0.7) 0px 5px 15px;"
      >Your Sparks</p>
  <div class="card bg-dark text-white image-container" style="height: 150px;">
    <%= image_tag("dashboard-2.jpeg", class: "card-img", alt: "Card image") %>
    <div class="gradient-overlay"></div>
  </div>
</div>
<%# <div class="container" style="margin-top: 70px"> %>
<div class="swiper mySwiper">
  <div class="swiper-wrapper">
    <% @suggestions.each do |suggestion| %>
      <div class="swiper-slide" data-suggestion-id="<%= suggestion.id %>">
        <div class="card p-3 ">
          <div class='img-container' style="background-image: url(<%= image_path('food-01.jpg') %>); min-height: 500px; margin-top: 30px">
        </div>
          <%= suggestion.title %>
        </div>
        
      </div>
    <% end %>
  </div>
</div>
<div>
  <script src="https://cdn.jsdelivr.net/npm/swiper@10/swiper-bundle.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/hammer.js/2.0.8/hammer.min.js"></script>
  <script>
    const swiper = new Swiper(".mySwiper", {
      effect: "cards",
      grabCursor: true,
    });
    swiper.on('slideChange', function () {
      console.log('slide changed');
    });

    //    https://hammerjs.github.io/recognizer-swipe/
    const suggestionCards = document.querySelectorAll(".swiper-slide");
    suggestionCards.forEach((card) => {
    const suggestionCard = new Hammer(card);

    // suggestionCard.on('swipeleft', function () {
    //   const suggestionId = card.getAttribute('data-suggestion-id');
    //   removeFromFavorites(suggestionId);
    // });
    suggestionCard.on('swiperight', function () {

    const suggestionId = card.getAttribute('data-suggestion-id');
                    console.log('Swipet right:', suggestionId);

     addToFavorites(suggestionId);
    });
    });

    function removeFromFavorites(suggestionId) {
      console.log('Swipet left:', suggestionId);
    }

    function addToFavorites(suggestionId) {
    const csrfToken = document.querySelector('meta[name="csrf-token"]').getAttribute('content');
    fetch(`/favorites`, {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json',
      'X-CSRF-Token': csrfToken,
    },
    body: JSON.stringify({ suggestion_id:suggestionId }),
    })
    .then((response) => {
      if (response.ok) {
                console.log('success');
      } else {
        console.error('Failed to add to favorites :', response.status);
      }
    })
    .catch((error) => {
      console.error(error);
    });
    }
  </script>
</div>
